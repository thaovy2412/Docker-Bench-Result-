[1;33m# ------------------------------------------------------------------------------
# Docker Bench for Security v1.3.5
#
# Docker, Inc. (c) 2015-
#
# Checks for dozens of common best-practices around deploying Docker containers in production.
# Inspired by the CIS Docker Benchmark v1.2.0.
# ------------------------------------------------------------------------------[0m

Initializing Thu Mar  4 14:07:25 UTC 2021


[1;34m[INFO][0m 1 - Host Configuration

[1;34m[INFO][0m 1.1 - General Configuration
[1;33m[NOTE][0m 1.1.1  - Ensure the container host has been Hardened (Not Scored)
[1;34m[INFO][0m 1.1.2  - Ensure that the version of Docker is up to date (Not Scored)
[1;34m[INFO][0m        * Using 20.10.3, verify is it up to date as deemed necessary
[1;34m[INFO][0m        * Your operating system vendor may provide support and security maintenance for Docker

[1;34m[INFO][0m 1.2 - Linux Hosts Specific Configuration
WARNING: API is accessible on http://0.0.0.0:4243 without encryption.
         Access to the remote API is equivalent to root access on the host. Refer
         to the 'Docker daemon attack surface' section in the documentation for
         more information: https://docs.docker.com/engine/security/security/#docker-daemon-attack-surface
WARNING: No swap limit support
WARNING: No blkio weight support
WARNING: No blkio weight_device support
[1;31m[WARN][0m 1.2.1 - Ensure a separate partition for containers has been created (Scored)
[1;34m[INFO][0m 1.2.2  - Ensure only trusted users are allowed to control Docker daemon (Scored)
[1;34m[INFO][0m        * docker:x:999:ttv
[1;31m[WARN][0m 1.2.3  - Ensure auditing is configured for the Docker daemon (Scored)
[1;31m[WARN][0m 1.2.4  - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Scored)
[1;31m[WARN][0m 1.2.5  - Ensure auditing is configured for Docker files and directories - /etc/docker (Scored)
[1;34m[INFO][0m 1.2.6  - Ensure auditing is configured for Docker files and directories - docker.service (Scored)
[1;34m[INFO][0m        * File not found
[1;34m[INFO][0m 1.2.7  - Ensure auditing is configured for Docker files and directories - docker.socket (Scored)
[1;34m[INFO][0m        * File not found
[1;31m[WARN][0m 1.2.8  - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Scored)
[1;34m[INFO][0m 1.2.9  - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Scored)
[1;34m[INFO][0m        * File not found
[1;34m[INFO][0m 1.2.10  - Ensure auditing is configured for Docker files and directories - /etc/docker/daemon.json (Scored)
[1;34m[INFO][0m         * File not found
[1;34m[INFO][0m 1.2.11  - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Scored)
[1;34m[INFO][0m         * File not found
[1;34m[INFO][0m 1.2.12  - Ensure auditing is configured for Docker files and directories - /usr/sbin/runc (Scored)
[1;34m[INFO][0m         * File not found


[1;34m[INFO][0m 2 - Docker daemon configuration
[1;31m[WARN][0m 2.1  - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.2  - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.3  - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.4  - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.5  - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.6  - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.7  - Ensure the default ulimit is configured appropriately (Not Scored)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.8  - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.9  - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.10  - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.11  - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.12  - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.13  - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.14  - Ensure Userland Proxy is Disabled (Scored)
[1;32m[PASS][0m 2.15  - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Not Scored)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)
[1;31m[WARN][0m 2.17  - Ensure containers are restricted from acquiring new privileges (Scored)


[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;34m[INFO][0m 3.1  - Ensure that the docker.service file ownership is set to root:root (Scored)
[1;34m[INFO][0m      * File not found
[1;34m[INFO][0m 3.2  - Ensure that docker.service file permissions are appropriately set (Scored)
[1;34m[INFO][0m      * File not found
[1;34m[INFO][0m 3.3  - Ensure that docker.socket file ownership is set to root:root (Scored)
[1;34m[INFO][0m      * File not found
[1;34m[INFO][0m 3.4  - Ensure that docker.socket file permissions are set to 644 or more restrictive (Scored)
[1;34m[INFO][0m      * File not found
[1;32m[PASS][0m 3.5  - Ensure that the /etc/docker directory ownership is set to root:root (Scored)
[1;32m[PASS][0m 3.6  - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Scored)
[1;34m[INFO][0m 3.7  - Ensure that registry certificate file ownership is set to root:root (Scored)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8  - Ensure that registry certificate file permissions are set to 444 or more restrictively (Scored)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9  - Ensure that TLS CA certificate file ownership is set to root:root (Scored)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10  - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Scored)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11  - Ensure that Docker server certificate file ownership is set to root:root (Scored)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12  - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Scored)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13  - Ensure that the Docker server certificate key file ownership is set to root:root (Scored)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14  - Ensure that the Docker server certificate key file permissions are set to 400 (Scored)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15  - Ensure that the Docker socket file ownership is set to root:docker (Scored)
[1;32m[PASS][0m 3.16  - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Scored)
[1;34m[INFO][0m 3.17  - Ensure that the daemon.json file ownership is set to root:root (Scored)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18  - Ensure that daemon.json file permissions are set to 644 or more restrictive (Scored)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19  - Ensure that the /etc/default/docker file ownership is set to root:root (Scored)
[1;34m[INFO][0m 3.20  - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Scored)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.21  - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Scored)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.22  - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Scored)


[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1  - Ensure that a user for the container has been created (Scored)
[1;31m[WARN][0m      * Running as root: gitlab
[1;31m[WARN][0m      * Running as root: registry
[1;33m[NOTE][0m 4.2  - Ensure that containers use only trusted base images (Not Scored)
[1;33m[NOTE][0m 4.3  - Ensure that unnecessary packages are not installed in the container (Not Scored)
[1;33m[NOTE][0m 4.4  - Ensure images are scanned and rebuilt to include security patches (Not Scored)
[1;31m[WARN][0m 4.5  - Ensure Content trust for Docker is Enabled (Scored)
[1;31m[WARN][0m 4.6  - Ensure that HEALTHCHECK instructions have been added to container images (Scored)
[1;31m[WARN][0m      * No Healthcheck found: [alpine:3.13]
[1;31m[WARN][0m      * No Healthcheck found: [jenkins/jenkins:lts]
[1;31m[WARN][0m      * No Healthcheck found: [registry:2.6.2]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7  - Ensure update instructions are not use alone in the Dockerfile (Not Scored)
[1;34m[INFO][0m      * Update instruction found: [jenkins/jenkins:lts]
[1;34m[INFO][0m      * Update instruction found: [gitlab/gitlab-ee:13.3.2-ee.0]
[1;33m[NOTE][0m 4.8  - Ensure setuid and setgid permissions are removed (Not Scored)
[1;32m[PASS][0m 4.9  - Ensure that COPY is used instead of ADD in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.10  - Ensure secrets are not stored in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.11  - Ensure only verified packages are are installed (Not Scored)


[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: gitlab
[1;31m[WARN][0m      * No SecurityOptions Found: jenkins
[1;31m[WARN][0m      * No SecurityOptions Found: registry
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;31m[WARN][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;31m[WARN][0m      * Container running sshd: gitlab
[1;31m[WARN][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;31m[WARN][0m      * Privileged Port in use: 22 in gitlab
[1;31m[WARN][0m      * Privileged Port in use: 443 in gitlab
[1;31m[WARN][0m      * Privileged Port in use: 80 in gitlab
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m      * Container running without memory restrictions: gitlab
[1;31m[WARN][0m      * Container running without memory restrictions: jenkins
[1;31m[WARN][0m      * Container running without memory restrictions: registry
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m      * Container running without CPU restrictions: gitlab
[1;31m[WARN][0m      * Container running without CPU restrictions: jenkins
[1;31m[WARN][0m      * Container running without CPU restrictions: registry
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m      * Container running with root FS mounted R/W: gitlab
[1;31m[WARN][0m      * Container running with root FS mounted R/W: jenkins
[1;31m[WARN][0m      * Container running with root FS mounted R/W: registry
[1;31m[WARN][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m      * Port being bound to wildcard IP: 0.0.0.0 in gitlab
[1;31m[WARN][0m      * Port being bound to wildcard IP: 0.0.0.0 in gitlab
[1;31m[WARN][0m      * Port being bound to wildcard IP: 0.0.0.0 in gitlab
[1;31m[WARN][0m      * Port being bound to wildcard IP: 0.0.0.0 in jenkins
[1;31m[WARN][0m      * Port being bound to wildcard IP: 0.0.0.0 in jenkins
[1;31m[WARN][0m      * Port being bound to wildcard IP: 0.0.0.0 in registry
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m      * MaximumRetryCount is not set to 5: gitlab
[1;31m[WARN][0m      * MaximumRetryCount is not set to 5: jenkins
[1;31m[WARN][0m      * MaximumRetryCount is not set to 5: registry
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m      * Container no default ulimit override: gitlab
[1;34m[INFO][0m      * Container no default ulimit override: jenkins
[1;34m[INFO][0m      * Container no default ulimit override: registry
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m      * Privileges not restricted: gitlab
[1;31m[WARN][0m      * Privileges not restricted: jenkins
[1;31m[WARN][0m      * Privileges not restricted: registry
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m      * Health check not set: jenkins
[1;31m[WARN][0m      * Health check not set: registry
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m      * PIDs limit not set: gitlab
[1;31m[WARN][0m      * PIDs limit not set: jenkins
[1;31m[WARN][0m      * PIDs limit not set: registry
[1;32m[PASS][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;31m[WARN][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)
[1;31m[WARN][0m      * Docker socket shared: jenkins


[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1  - Ensure that image sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently: 9 images
[1;34m[INFO][0m 6.2  - Ensure that container sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently a total of 5 containers, with 4 of them currently running


[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1  - Ensure swarm mode is not Enabled, if not needed (Scored)
[1;32m[PASS][0m 7.2  - Ensure that the minimum number of manager nodes have been created in a swarm (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3  - Ensure that swarm services are bound to a specific host interface (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.4  - Ensure that all Docker swarm overlay networks are encrypted (Scored)
[1;32m[PASS][0m 7.5  - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6  - Ensure that swarm manager is run in auto-lock mode (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7  - Ensure that the swarm manager auto-lock key is rotated periodically (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8  - Ensure that node certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9  - Ensure that CA certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.10  - Ensure that management plane traffic is separated from data plane traffic (Not Scored) (Swarm mode not enabled)


[1;34m[INFO][0m 8 - Docker Enterprise Configuration
[1;34m[INFO][0m   * Community Engine license, skipping section 8

[1;34m[INFO][0m Checks: 107
[1;34m[INFO][0m Score: 9
