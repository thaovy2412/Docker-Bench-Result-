{
  "dockerbenchsecurity": "1.3.5",
  "start": 1614866945,
  "tests": [
    {"id": "1", "desc": "Host Configuration",  "results": [
      {"id": "1.1.1", "desc": "Ensure the container host has been Hardened (Not Scored)", "result": "INFO"},
      {"id": "1.1.2", "desc": "Ensure that the version of Docker is up to date (Not Scored)", "result": "INFO", "details": "Using 20.10.3"},
      {"id": "1.2.1", "desc": "Ensure a separate partition for containers has been created (Scored)", "result": "WARN"},
      {"id": "1.2.2", "desc": "Ensure only trusted users are allowed to control Docker daemon (Scored)", "result": "INFO", "details": "users: docker:x:999:ttv", "items": ["docker:x:999:ttv"]},
      {"id": "1.2.3", "desc": "Ensure auditing is configured for the Docker daemon (Scored)", "result": "WARN"},
      {"id": "1.2.4", "desc": "Ensure auditing is configured for Docker files and directories - /var/lib/docker (Scored)", "result": "WARN"},
      {"id": "1.2.5", "desc": "Ensure auditing is configured for Docker files and directories - /etc/docker (Scored)", "result": "WARN"},
      {"id": "1.2.6", "desc": "Ensure auditing is configured for Docker files and directories - docker.service (Scored)", "result": "WARN"},
      {"id": "1.2.7", "desc": "Ensure auditing is configured for Docker files and directories - docker.socket (Scored)", "result": "WARN"},
      {"id": "1.2.8", "desc": "Ensure auditing is configured for Docker files and directories - /etc/default/docker (Scored)", "result": "WARN"},
      {"id": "1.2.9", "desc": "Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Scored)", "result": "INFO", "details": "File not found"},
      {"id": "1.2.10", "desc": "Ensure auditing is configured for Docker files and directories - /etc/docker/daemon.json (Scored)", "result": "INFO", "details": "File not found"},
      {"id": "1.2.11", "desc": "Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Scored)", "result": "WARN"},
      {"id": "1.2.12", "desc": "Ensure auditing is configured for Docker files and directories - /usr/sbin/runc (Scored)", "result": "INFO", "details": "File not found"}
    ]},
    {"id": "2", "desc": "Docker daemon configuration",  "results": [
      {"id": "2.1", "desc": "Ensure network traffic is restricted between containers on the default bridge (Scored)", "result": "WARN"},
      {"id": "2.2", "desc": "Ensure the logging level is set to 'info' (Scored)", "result": "PASS"},
      {"id": "2.3", "desc": "Ensure Docker is allowed to make changes to iptables (Scored)", "result": "PASS"},
      {"id": "2.4", "desc": "Ensure insecure registries are not used (Scored)", "result": "PASS"},
      {"id": "2.5", "desc": "Ensure aufs storage driver is not used (Scored)", "result": "PASS"},
      {"id": "2.6", "desc": "Ensure TLS authentication for Docker daemon is configured (Scored)", "result": "INFO", "details": "Docker daemon not listening on TCP"},
      {"id": "2.7", "desc": "Ensure the default ulimit is configured appropriately (Not Scored)", "result": "INFO", "details": "Default ulimit doesn't appear to be set"},
      {"id": "2.8", "desc": "Enable user namespace support (Scored)", "result": "WARN"},
      {"id": "2.9", "desc": "Ensure the default cgroup usage has been confirmed (Scored)", "result": "PASS"},
      {"id": "2.10", "desc": "Ensure base device size is not changed until needed (Scored)", "result": "PASS"},
      {"id": "2.11", "desc": "Ensure that authorization for Docker client commands is enabled (Scored)", "result": "WARN"},
      {"id": "2.12", "desc": "Ensure centralized and remote logging is configured (Scored)", "result": "WARN"},
      {"id": "2.13", "desc": "Ensure live restore is enabled (Scored)", "result": "WARN"},
      {"id": "2.14", "desc": "Ensure Userland Proxy is Disabled (Scored)", "result": "WARN"},
      {"id": "2.15", "desc": "Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Not Scored)", "result": "PASS"},
      {"id": "2.16", "desc": "Ensure that experimental features are not implemented in production (Scored)", "result": "INFO"},
      {"id": "2.17", "desc": "Ensure containers are restricted from acquiring new privileges (Scored)", "result": "WARN"}
    ]},
    {"id": "3", "desc": "Docker daemon configuration files",  "results": [
      {"id": "3.1", "desc": "Ensure that the docker.service file ownership is set to root:root (Scored)", "result": "PASS"},
      {"id": "3.2", "desc": "Ensure that docker.service file permissions are appropriately set (Scored)", "result": "PASS"},
      {"id": "3.3", "desc": "Ensure that docker.socket file ownership is set to root:root (Scored)", "result": "PASS"},
      {"id": "3.4", "desc": "Ensure that docker.socket file permissions are set to 644 or more restrictive (Scored)", "result": "PASS"},
      {"id": "3.5", "desc": "Ensure that the /etc/docker directory ownership is set to root:root (Scored)", "result": "PASS"},
      {"id": "3.6", "desc": "Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Scored)", "result": "PASS"},
      {"id": "3.7", "desc": "Ensure that registry certificate file ownership is set to root:root (Scored)", "result": "INFO", "details": "Directory not found"},
      {"id": "3.8", "desc": "Ensure that registry certificate file permissions are set to 444 or more restrictively (Scored)", "result": "INFO", "details": "Directory not found"},
      {"id": "3.9", "desc": "Ensure that TLS CA certificate file ownership is set to root:root (Scored)", "result": "INFO", "details": "No TLS CA certificate found"},
      {"id": "3.10", "desc": "Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Scored)", "result": "INFO", "details": "No TLS CA certificate found"},
      {"id": "3.11", "desc": "Ensure that Docker server certificate file ownership is set to root:root (Scored)", "result": "INFO", "details": "No TLS Server certificate found"},
      {"id": "3.12", "desc": "Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Scored)", "result": "INFO", "details": "No TLS Server certificate found"},
      {"id": "3.13", "desc": "Ensure that the Docker server certificate key file ownership is set to root:root (Scored)", "result": "INFO", "details": "No TLS Key found"},
      {"id": "3.14", "desc": "Ensure that the Docker server certificate key file permissions are set to 400 (Scored)", "result": "INFO", "details": "No TLS Key found"},
      {"id": "3.15", "desc": "Ensure that the Docker socket file ownership is set to root:docker (Scored)", "result": "PASS"},
      {"id": "3.16", "desc": "Ensure that the Docker socket file permissions are set to 660 or more restrictively (Scored)", "result": "PASS"},
      {"id": "3.17", "desc": "Ensure that the daemon.json file ownership is set to root:root (Scored)", "result": "INFO", "details": "File not found"},
      {"id": "3.18", "desc": "Ensure that daemon.json file permissions are set to 644 or more restrictive (Scored)", "result": "INFO", "details": "File not found"},
      {"id": "3.19", "desc": "Ensure that the /etc/default/docker file ownership is set to root:root (Scored)", "result": "PASS"},
      {"id": "3.20", "desc": "Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Scored)", "result": "INFO", "details": "File not found"},
      {"id": "3.21", "desc": "Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Scored)", "result": "INFO", "details": "File not found"},
      {"id": "3.22", "desc": "Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Scored)", "result": "PASS"}
    ]},
    {"id": "4", "desc": "Container Images and Build File",  "results": [
      {"id": "4.1", "desc": "Ensure that a user for the container has been created (Scored)", "result": "WARN", "details": "running as root:  gitlab registry", "items": ["gitlab","registry"]},
      {"id": "4.2", "desc": "Ensure that containers use only trusted base images (Not Scored)", "result": "NOTE"},
      {"id": "4.3", "desc": "Ensure that unnecessary packages are not installed in the container (Not Scored)", "result": "NOTE"},
      {"id": "4.4", "desc": "Ensure images are scanned and rebuilt to include security patches (Not Scored)", "result": "NOTE"},
      {"id": "4.5", "desc": "Ensure Content trust for Docker is Enabled (Scored)", "result": "WARN"},
      {"id": "4.6", "desc": "Ensure that HEALTHCHECK instructions have been added to container images (Scored)", "result": "WARN", "details": "Images w/o HEALTHCHECK:  [alpine:3.13] [jenkins/jenkins:lts] [registry:2.6.2] [hello-world:latest]", "items": ["[alpine:3.13]","[jenkins/jenkins:lts]","[registry:2.6.2]","[hello-world:latest]"]},
      {"id": "4.7", "desc": "Ensure update instructions are not used alone in the Dockerfile (Not Scored)", "result": "INFO", "details": "Update instructions found:  [jenkins/jenkins:lts] [gitlab/gitlab-ee:13.3.2-ee.0]", "items": ["[jenkins/jenkins:lts]","[gitlab/gitlab-ee:13.3.2-ee.0]"]},
      {"id": "4.8", "desc": "Ensure setuid and setgid permissions are removed (Not Scored)", "result": "NOTE"},
      {"id": "4.9", "desc": "Ensure that COPY is used instead of ADD in Dockerfiles (Not Scored)", "result": "PASS"},
      {"id": "4.10", "desc": "Ensure secrets are not stored in Dockerfiles (Not Scored)", "result": "NOTE"},
      {"id": "4.11", "desc": "Ensure only verified packages are are installed (Not Scored)", "result": "NOTE"}
    ]},
    {"id": "5", "desc": "Container Runtime",  "results": [
      {"id": "5.1", "desc": "Ensure that, if applicable, an AppArmor Profile is enabled (Scored)", "result": "PASS"},
      {"id": "5.2", "desc": "Ensure that, if applicable, SELinux security options are set (Scored)", "result": "WARN", "details": "Containers with no SecurityOptions:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.3", "desc": "Ensure that Linux kernel capabilities are restricted within containers (Scored)", "result": "PASS"},
      {"id": "5.4", "desc": "Ensure that privileged containers are not used (Scored)", "result": "PASS"},
      {"id": "5.5", "desc": "Ensure sensitive host system directories are not mounted on containers (Scored)", "result": "PASS"},
      {"id": "5.6", "desc": "Ensure sshd is not run within containers (Scored)", "result": "WARN", "details": "Containers with sshd/docker exec failures:  gitlab", "items": ["gitlab"]},
      {"id": "5.7", "desc": "Ensure privileged ports are not mapped within containers (Scored)", "result": "WARN", "details": "Containers using privileged ports:  gitlab:22 gitlab:443 gitlab:80", "items": ["gitlab:22","gitlab:443","gitlab:80"]},
      {"id": "5.8", "desc": "Ensure that only needed ports are open on the container (Not Scored)", "result": "NOTE"},
      {"id": "5.9", "desc": "Ensure that the host's network namespace is not shared (Scored)", "result": "PASS"},
      {"id": "5.10", "desc": "Ensure that the memory usage for containers is limited (Scored)", "result": "WARN", "details": "Container running without memory restrictions:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.11", "desc": "Ensure that CPU priority is set appropriately on containers (Scored)", "result": "WARN", "details": "Containers running without CPU restrictions:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.12", "desc": "Ensure that the container's root filesystem is mounted as read only (Scored)", "result": "WARN", "details": "Containers running with root FS mounted R/W:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.13", "desc": "Ensure that incoming container traffic is bound to a specific host interface (Scored)", "result": "WARN", "details": "Containers with port bound to wildcard IP:  gitlab:0.0.0.0 gitlab:0.0.0.0 gitlab:0.0.0.0 jenkins:0.0.0.0 jenkins:0.0.0.0 registry:0.0.0.0", "items": ["gitlab:0.0.0.0","gitlab:0.0.0.0","gitlab:0.0.0.0","jenkins:0.0.0.0","jenkins:0.0.0.0","registry:0.0.0.0"]},
      {"id": "5.14", "desc": "Ensure that the 'on-failure' container restart policy is set to '5' (Scored)", "result": "WARN", "details": "Containers with MaximumRetryCount not set to 5:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.15", "desc": "Ensure that the host's process namespace is not shared (Scored)", "result": "PASS"},
      {"id": "5.16", "desc": "Ensure that the host's IPC namespace is not shared (Scored)", "result": "PASS"},
      {"id": "5.17", "desc": "Ensure that host devices are not directly exposed to containers (Not Scored)", "result": "PASS"},
      {"id": "5.18", "desc": "Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)", "result": "INFO", "details": "Containers with no default ulimit override:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.19", "desc": "Ensure mount propagation mode is not set to shared (Scored)", "result": "PASS"},
      {"id": "5.20", "desc": "Ensure that the host's UTS namespace is not shared (Scored)", "result": "PASS"},
      {"id": "5.21", "desc": "Ensurethe default seccomp profile is not Disabled (Scored)", "result": "PASS"},
      {"id": "5.22", "desc": "Ensure that docker exec commands are not used with the privileged option (Scored)", "result": "NOTE"},
      {"id": "5.23", "desc": "Ensure that docker exec commands are not used with the user=root option (Not Scored)", "result": "NOTE"},
      {"id": "5.24", "desc": "Ensure that cgroup usage is confirmed (Scored)", "result": "PASS"},
      {"id": "5.25", "desc": "Ensure that the container is restricted from acquiring additional privileges (Scored)", "result": "WARN", "details": "Containers without restricted privileges:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.26", "desc": "Ensure that container health is checked at runtime (Scored)", "result": "WARN", "details": "Containers without health check:  jenkins registry", "items": ["jenkins","registry"]},
      {"id": "5.27", "desc": "Ensure that Docker commands always make use of the latest version of their image (Not Scored)", "result": "INFO"},
      {"id": "5.28", "desc": "Ensure that the PIDs cgroup limit is used (Scored)", "result": "WARN", "details": "Containers without PIDs cgroup limit:  gitlab jenkins registry", "items": ["gitlab","jenkins","registry"]},
      {"id": "5.29", "desc": "Ensure that Docker's default bridge docker0 is not used (Not Scored)", "result": "PASS"},
      {"id": "5.30", "desc": "Ensure that the host's user namespaces are not shared (Scored)", "result": "PASS"},
      {"id": "5.31", "desc": "Ensure that the Docker socket is not mounted inside any containers (Scored)", "result": "WARN", "details": "Containers sharing docker socket:  jenkins", "items": ["jenkins"]}
    ]},
    {"id": "6", "desc": "Docker Security Operations",  "results": [
      {"id": "6.1", "desc": "Ensure that image sprawl is avoided (Not Scored)", "result": "INFO", "details": "4 active/9 in use"},
      {"id": "6.2", "desc": "Ensure that container sprawl is avoided (Not Scored)", "result": "INFO", "details": "4 total/3 running"}
    ]},
    {"id": "7", "desc": "Docker Swarm Configuration",  "results": [
      {"id": "7.1", "desc": "Ensure swarm mode is not Enabled, if not needed (Scored)", "result": "PASS"},
      {"id": "7.2", "desc": "Ensure that the minimum number of manager nodes have been created in a swarm (Scored)", "result": "PASS"},
      {"id": "7.3", "desc": "Ensure that swarm services are bound to a specific host interface (Scored)", "result": "PASS"},
      {"id": "7.4", "desc": "Ensure that all Docker swarm overlay networks are encrypted (Scored)", "result": "PASS"},
      {"id": "7.5", "desc": "Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Not Scored)", "result": "PASS"},
      {"id": "7.6", "desc": "Ensure that swarm manager is run in auto-lock mode (Scored)", "result": "PASS"},
      {"id": "7.7", "desc": "Ensure that the swarm manager auto-lock key is rotated periodically (Not Scored)", "result": "PASS"},
      {"id": "7.8", "desc": "Ensure that node certificates are rotated as appropriate (Not Scored)", "result": "PASS"},
      {"id": "7.9", "desc": "Ensure that CA certificates are rotated as appropriate (Not Scored)", "result": "PASS"},
      {"id": "7.10", "desc": "Ensure that management plane traffic is separated from data plane traffic (Not Scored)", "result": "PASS"}
    ]},
    {"id": "8", "desc": "Docker Enterprise Configuration",  "results": [
    ]}
  ], "checks": 107, "score": 10, "end": 1614866957 
}
